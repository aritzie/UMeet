<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org" th:replace="layout/layout::layout( ~{::body})">
    <body>
        <div class="row text-white ml-5 pl-5 mt-3" id="chat">
            <div class="col-sm-2 col-xs-12" style="border-top-left-radius: 15px; border-bottom-left-radius: 15px">
                <div class="col-inside-lg chat overflow-off-x" style="overflow-y: auto; outline: none;" tabindex="5000">

                    <div class="mx-1 d-flex flex-row">
                        <span class="h4 col-9" th:each="ser:${server}">
                            <!--<img th:src="@{/profile/avatar(url=${ser.avatar})}" class="avatar-server" height="150px" width="250px">-->
                            <span class="long-name" th:text="${ser.name}"></span>
                        </span>
                    </div>
                    <hr style="height: 2px;">

                    <div class="ml-1 overflow-off-x" id="contentServer">
                        <ul class="mb-3" style="padding-inline-start: 0;" th:each="category:${categories}">
                            <li>
                                <div class="list-group-item hover-server option-gear">

                                    <i class='fas fa-chevron-down mt-1 flechitas'></i>&nbsp;&nbsp;
                                    <a class="pulsador" data-toggle="collapse" th:href="'#collapse'+${category.id}" th:text="${category.name}" id="accordation-2"></a>

                                    <div th:if="${usr.rol.id==1}" class="dropdown show-gear gear"> <!<!-- show-gear gear -->
                                        <a class=" iconServer" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="text-decoration: none">
                                            <i class="fas fa-cog tips" title="Opciones de la categoria"></i>
                                        </a>
                                        <div class="dropdown-menu text-center">
                                            <a th:onclick="|editCategory(null,${category.id})|" class="col-1 text-white">
                                                &nbsp;<i class="far fa-edit tips" title="Editar Categoria"></i>
                                            </a>
                                            <a th:href="@{/category/deleteCategory(idCategory=${category.id})}" class="col-1 delete-trash">
                                                &nbsp;<i class="far fa-trash-alt tips delete-trash" title="Borrar Categoria"></i>
                                            </a>
                                            <a th:onclick="|editChannel(${category.id})|" class="col-1 text-white"
                                               >&nbsp;<i class="fas fa-plus tips" title="A単adir Canal"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>

                                <a class="collapse show" th:id="'collapse'+${category.id}" data-parent="#accordation" th:if="${usr.rol.id==1}" th:onclick="|editChannel(${category.id})|"></a>

                                <ul class="collapse show" th:id="'collapse'+${category.id}" data-parent="#accordation" th:each="channel:${category.channels}">
                                    <li>
                                        <div class="list-group-item hover-server">
                                            <i class="fas fa-hashtag" style="margin-top:4px">&nbsp;</i>
                                            <a th:if="${channel!=null}" th:attr="onclick=|chat('${channel.id}','${channel.name}')|" th:text="${channel.name}" id="accordation"></a>

                                            <div class="children-cat">
                                                <a th:if="${usr.rol.id==1}" th:onclick="|editChannel(null,${channel.id})|" style=":hover{color: #86C232}" class="text-white">
                                                    <i class="far fa-edit tips" title="Editar Canal"></i>
                                                </a>
                                                <a th:if="${usr.rol.id==1}" th:href="@{/channel/deleteChannel(idChannel=${channel.id})}" class="delete-trash">
                                                    <i class="far fa-trash-alt delete-trash tips" title="Eliminar Canal"></i>
                                                </a>
                                            </div>    
                                        </div>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                </div>
            </div>
            <div class="col-sm-7 col-xs-12 chat" style="overflow: hidden; outline: none;" tabindex="5001">
                <div class="col-inside-lg ">

                    <div class="mx-1 d-flex flex-row">
                        <span class="h4 col-9" style="text-align: left;">
                            <span id='channel-name'>&nbsp;</span>
                        </span>
                        <div class="h4 col-3" style="text-align: right;">
                            <div class="dropleft">
                                <a th:if="${usr.rol.id==1}" class=" iconServer" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="text-decoration: none">
                                    <i class="fas fa-cog tips" title="Opciones del servidor"> </i>
                                </a>
                                <a th:onclick="|confirmServer(${idServer}, '多Desea salir del servidor?', '/usr/leaveServer')|" class="iconServer tips" title="Salir del servidor"><i class="fas fa-sign-out-alt"></i></a>
                                <div class="dropdown-menu">
                                    <a th:onclick="|editServer(${idServer})|" class="iconServer dropdown-item">
                                        Editar <i class="offset-5 col-6 far fa-edit"></i>
                                    </a>
                                    <a th:onclick="|editCategory(${idServer})|" class="iconServer dropdown-item">
                                        A単adir<i class="offset-5 col-6 fas fa-plus"></i>
                                    </a>
                                    <a th:onclick="|confirmServer(${idServer}, '多Desea eliminar el servidor?', '/server/deleteServer')|" class="iconServer dropdown-item delete-trash">
                                        Eliminar<i class="offset-4 col-6 far fa-trash-alt delete-trash"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr style="height: 2px;">
                    <div class="chat-body text-left">
                        <div class="overflow-auto overflow-off-x mb-3 chat-body" id="contentChat">
                            <div style="text-align: left" class="h1 ml-5  mt-5" th:each="ser:${server}">
<!--                                <div th:text="${ser.name}"></div>
                                <div th:text="${ser.description}"></div>-->
                                Bienvenido al servidor  "<span th:text="${ser.name}"></span>"
                            </div>
                        </div>
                        <div class="row-sin-m">
                            <div id="sendit" class="send-msg-field"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-2 col-xs-12" style="border-top-right-radius: 15px; border-bottom-right-radius: 15px">
                <div class="col-inside-lg chat" style="overflow-y: auto; outline: none;" tabindex="5000">
                    <div class="chat-users">
                        <div class="mx-1 d-flex flex-row">
                            <span class="h4">
                                <span>Usuarios</span>
                            </span>
                        </div>
                        <hr style="height: 2px;">
                        <div class="user" th:each="us:${userServer}">
                            <div class="avatar">
                                <img th:src="@{/profile/avatar(url=${us.user.avatar})}" width="40px" height="40px">
                                <div  th:if="${us.user.status} == 'conectado'" class="status conectado"></div>
                                <div  th:if="${us.user.status} == 'desconectado'" class="status desconectado"></div>
                                <div  th:if="${us.user.status} == 'ocupado'" class="status ocupado"></div>
                                <div  th:if="${us.user.status} == 'ausente'" class="status ausente"></div>
                            </div>
                            <div class="name" th:text="${us.user.nickName}"></div>
                            <div class="mood">U-Meet</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
